{"version":3,"sources":["../../../src/api/withAuth.ts"],"sourcesContent":["import type { ClerkMiddlewareOptions, WithAuthProp } from '@clerk/clerk-sdk-node';\nimport { createClerkExpressWithAuth } from '@clerk/clerk-sdk-node';\nimport type { NextApiRequest, NextApiResponse } from 'next';\n\nimport { API_URL, clerkClient, FRONTEND_API, PUBLISHABLE_KEY } from '../server';\nimport { runMiddleware } from './utils';\n\ntype NextApiHandlerWithAuth<T = any> = (\n  req: WithAuthProp<NextApiRequest>,\n  res: NextApiResponse<T>,\n) => void | Promise<void>;\n\nexport function withAuth(handler: NextApiHandlerWithAuth, options?: ClerkMiddlewareOptions): NextApiHandlerWithAuth {\n  return async (req, res) => {\n    await runMiddleware(\n      req,\n      res,\n      createClerkExpressWithAuth({\n        clerkClient,\n        frontendApi: FRONTEND_API,\n        apiUrl: API_URL,\n        publishableKey: PUBLISHABLE_KEY,\n      })(options),\n    );\n\n    return handler(req, res);\n  };\n}\n"],"mappings":"AACA,SAAS,kCAAkC;AAG3C,SAAS,SAAS,aAAa,cAAc,uBAAuB;AACpE,SAAS,qBAAqB;AAOvB,SAAS,SAAS,SAAiC,SAA0D;AAClH,SAAO,OAAO,KAAK,QAAQ;AACzB,UAAM;AAAA,MACJ;AAAA,MACA;AAAA,MACA,2BAA2B;AAAA,QACzB;AAAA,QACA,aAAa;AAAA,QACb,QAAQ;AAAA,QACR,gBAAgB;AAAA,MAClB,CAAC,EAAE,OAAO;AAAA,IACZ;AAEA,WAAO,QAAQ,KAAK,GAAG;AAAA,EACzB;AACF;","names":[]}